<!DOCTYPE html>
<html>
  <head>
    <title>ChatBot</title>
  </head>
  <body>
    <div class="js-container"></div>

    <script src="react_basics.js"></script>
    <script src="https://unpkg.com/supersimpledev/react.js"></script>
    <script src="https://unpkg.com/supersimpledev/react-dom.js"></script>


    <script src="https://unpkg.com/supersimpledev/chatbot.js"></script>
    <script src="https://unpkg.com/supersimpledev/babel.js"></script>


    <script type="text/babel">

        function ChatInput({chatMessages, setChatMessages}){

          const [inputText, setInputText]=React.useState('');

          function saveInputText(event){
            setInputText(event.target.value);
          }


          function sendMessage(){

            const newChatMessages=[
                ...chatMessages,
                {
                  message: inputText,
                  sender:'user',
                  id:crypto.randomUUID()
                }
            ]
           
            setChatMessages(newChatMessages);

            const response = Chatbot.getResponse(inputText);
            
            setChatMessages([
                ...newChatMessages,
                {
                  message: response,
                  sender:'robot',
                  id:crypto.randomUUID()
                }
            ]);

            setInputText('');
          }

          return (
            <>
              <input placeholder="Send a message" size="30" 
                onChange={saveInputText} 
                value={inputText}
              />
              
              <button
                onClick={sendMessage}
              >
                Send</button>
            </>
          );
        }



        
        function ChatMessage({message, sender}){
            return(
              <div>
                {sender==='robot' && <img src="car2.jpg" width="50" />}
                {message}
                {sender==='user' && <img src="car1.jpg" width="50" />}
              </div>
            );  

        }


        function ChatMessages({chatMessages}){
            
            return(
              <>
                {chatMessages.map((chatMessage) =>{
                  return (
                    <ChatMessage  
                      message={chatMessage.message} 
                      sender={chatMessage.sender}
                      key={chatMessage.id}
                    />
                    );
                  } )
                }
              </>
            )

        }

        function App(){

          const [chatMessages, setChatMessages] =React.useState([{
                message: 'Hello chatbot',
                sender:'user',
                id:'id1'
              },
              {
                message: 'Hello how can I help you',
                sender:'robot',
                id:'id2'
              },
              {
                message: 'can you get me today date',
                sender:'user',
                id:'id3'
              },{
                message: 'today is november 24',
                sender:'robot',
                id:'id4'
              }]
            );

          return(
            <>
               <ChatInput 
                  chatMessages={chatMessages}
                  setChatMessages={setChatMessages}
               /> 
               <ChatMessages 
                  chatMessages={chatMessages}
               />
            </>
          );
        }
        
        // we can insert any javascript code in the {} brackets ChatInput is a javascript code but we inserted them into react using {}
        // <ChatInput></Chatinput> and {ChatInput} both creates same but <ChatInput></ChatInput> has more advantage
        

      const container = document.querySelector('.js-container'); // here we are putiing .(dot) so we are looking for a class (here js-container is a class)
      //ReactDOM.createRoot(container).render('Welcome to SuperSimpleDev React Course');

      ReactDOM.createRoot(container).render(<App />);
    </script>
  </body>
</html>
